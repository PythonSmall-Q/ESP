apiVersion: v1
kind: ConfigMap
metadata:
  name: efp-gateway-nginx
  namespace: efp-production
data:
  nginx.conf: |
    events {}
    http {
      upstream user_service { server user-service:8080; }
      upstream approval_service { server approval-service:8080; }
      upstream project_service { server project-service:8080; }
      upstream calendar_service { server calendar-service:8080; }
      upstream booking_service { server booking-service:8080; }
      upstream selfservice_service { server selfservice-service:8080; }
      upstream task_service { server task-service:3000; }
      upstream communication_service { server communication-service:3001; }
      upstream knowledge_service { server knowledge-service:3002; }
      upstream reporting_service { server reporting-service:3003; }
      upstream file_service { server file-service:8081; }
      upstream asset_service { server asset-service:8082; }

      server {
        listen 8080;
        location /api/user/ { proxy_pass http://user_service/; }
        location /api/approval/ { proxy_pass http://approval_service/; }
        location /api/project/ { proxy_pass http://project_service/; }
        location /api/calendar/ { proxy_pass http://calendar_service/; }
        location /api/booking/ { proxy_pass http://booking_service/; }
        location /api/selfservice/ { proxy_pass http://selfservice_service/; }
        location /api/task/ { proxy_pass http://task_service/; }
        location /api/communication/ { proxy_pass http://communication_service/; }
        location /api/knowledge/ { proxy_pass http://knowledge_service/; }
        location /api/reporting/ { proxy_pass http://reporting_service/; }
        location /api/file/ { proxy_pass http://file_service/; }
        location /api/asset/ { proxy_pass http://asset_service/; }
      }
    }